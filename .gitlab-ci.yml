image: docker:20.10.16

build_website:

    variables:
        IMAGE_NAME: ilefrjiba/t-014-website
        IMAGE_TAG: dev
    
    before_script: 
        - sudo apt-get install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin
        - docker --version
        - docker login -u $T014_DOCKER_HUB_USERNAME -p $T014_DOCKER_HUB_PASSWORD

    script:

        - cd ./applications/website/
        - docker build --tag $IMAGE_NAME:$IMAGE_TAG .
        - docker push $IMAGE_NAME:$IMAGE_TAG
    tags:
        - t-014-build-protected
    only:
    - t-014-dev