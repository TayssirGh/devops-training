version: '3'

services:

  qr:
    build: 
      context: ./qr
      dockerfile: Dockerfile
    environment:
      - QR_TMP_FOLDER="./generated_qr"
      - QR_FILL_COLOR="121128"
      - QR_BACKGROUND_COLOR="dcdbdb"
      - USE_BUCKET=true
      - BUCKET_ENDPOINT="minios3:9000"
      - BUCKET_ACCESS_KEY="U4KNjHfCQi2FXdgv9tIJ"
      - BUCKET_SECRET_KEY="HMTHWQTpn08UUFDBTvchC8CZdXe3SissQWVCCHeY"
      - BUCKET_NAME="qrbucket"
      - BUCKET_PATH="qrbucket"
    volumes:
      - qr_volume:/generated_qr
    networks:
      - privatenetwork

    
  backend:
    build: 
      context: ./backend
      dockerfile: Dockerfile
    environment:
      - APP_PORT=3040
      - QR_URL=http://qr:8420
      - MONGO_URI=mongodb+srv://azizos:azizos123@azizos.u0tduhr.mongodb.net
      - MONGO_DB=azizos
    depends_on:
      - qr
    networks:
      - privatenetwork


  website:
    build:
      context: ./website
      dockerfile: Dockerfile
    restart: always
    depends_on:
      - backend
      - qr
    volumes:
      - qr_volume:/generated_qr  
    networks:
      - appnetwork

networks:
  appnetwork:
  privatenetwork:

volumes:
  qr_volume:
